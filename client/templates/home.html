<div id="app">
    <header-bar></header-bar>
    <div id="timeline">
        <post-form></post-form>
        
        <div ng-hide="!loading" class="loading">
            <span class="ion ion-loading-c"></span> {{ 'loading' | translate }}
        </div>
        
        <div id="timeline-error" class="error hidden"></div>

        <div ng-repeat="post in posts" ng-hide="posts.length == 0">
            <div class="post">
                <div ng-show="postService.isMine(post)" ng-click="deletePost(post)" class="pull-right inline-icon"><span class="ion ion-close-round"></span></div>
                <div class="user-data">
                    <div class="avatar" ng-hide="userService.getAvatarThumb(post.user) == ''"></div>
                    <div class="default-avatar" ng-hide="userService.getAvatarThumb(post.user) != ''">
                        <span class="ion ion-android-contact"></span>
                    </div>
                    <a href="#/u/{{ post.user.username.toLowerCase() }}" class="username">{{ userService.getUsername(post.user) }}</a>
                    <span class="time" ng-click="goTo('/posts/' + post.id)">{{ post.timeFormatted }}</span>
                </div>
                <p class="text">{{ post.text }}</p>
                <div class="post-video" ng-hide="!postService.isKindOf(post, 'video')">
                    <sun-video video-id="{{ post.video_id }}" service="{{ post.video_service }}">
                </div>
                <div class="post-photo" ng-hide="!postService.isKindOf(post, 'photo')" style="background-image: url({{ post.photo_url }})">
                    <div class="photo">
                        <img data-ng-src="{{ post.thumbnail }}" title="{{ post.caption }}" ng-click="photoService.openTheater(post.photo_url, post.caption)">
                        <p class="caption" ng-show="post.caption.length > 0">{{ post.caption }}</p>
                    </div>
                </div>
                <div class="post-link" ng-hide="!postService.isKindOf(post, 'link')">
                    <a ng-href="{{ post.link_url }}" target="_blank" title="{{ postService.getLinkTitle(post) }}">{{ postService.getLinkTitle(post) }} <span class="ion ion-arrow-right-c"></span></a>
                    <p class="url">{{ post.link_url }}</p>
                </div>
                <div class="actions">
                    <ul>
                        <li ng-click="likePost($index)" ng-class="posts[$index].className"><span class="ion ion-thumbsup"></span> <span class="count" ng-bind="posts[$index].likes"></span></li>
                        <li ng-click="commentPost(post)"><span class="ion ion-chatbubbles"></span> <span class="count">{{ post.comments_num }}</span></li>  
                        <li ng-show="postService.isMine(post)" ng-click="changePostPrivacy(post)" class="pull-right"><span class="ion ion-gear-b icon-only"></span></li>
                    </ul>
                </div>
                <div class="comments" ng-hide="!!post.comments.length">
                </div>
            </div>
        </div>

        <div class="no-posts-message" ng-hide="posts.length != 0">
            <span class="emoticon">:-(</span>
            <span class="title">{{ 'no_posts_title' | translate }}</span>
            <span class="message">{{ 'no_posts_message' | translate }}</span>
        </div>
        <photo-theater />
    </div> 
    <confirm-dialog />
</div>